% !Mode:: "TeX:DE:UTF-8:Main"

\documentclass[parskip=half-]{scrartcl}
\usepackage{combofont}
\usepackage{fontspec}
\setmainfont{arial}
\usepackage{xcolor}


\setupcombofont{combotest-regular}
 {
  {file:ariali.ttf:\combodefaultfeat;+smcp} at #1pt,
  {file:arial.ttf:\combodefaultfeat;+smcp} at \fpeval{#1/10*15}pt,
  {file:cmunrm.otf:\combodefaultfeat}            at #1pt
 }
 {
   {} , 
   0x41-0x7A*0xDF-0xEA, 
   fallback
 }

\setupcombofont{combotest-bold}
 {
  {file:lmroman10-bold:\combodefaultfeat} at #1pt,
  {file:lmsans10-bold.otf:\combodefaultfeat} at \fpeval{#1/10*15}pt,
  {file:cmunbbx.otf:\combodefaultfeat} at #1pt
 }
 {
   {} , 0x41-0x5A*0xDF-0xEA, fallback
 }



\DeclareFontFamily{TU}{combotest}{}
\DeclareFontShape{TU} {combotest}{m}{n}{<->combo*combotest-regular}{}
\DeclareFontShape{TU} {combotest}{bx}{n}{<->combo*combotest-bold}{}



\begin{document}
\section{Call through nfss?}
\scshape abc
\font\test={file:lmroman10-regular.otf:+smcp}\test abc

\normalsize 
\fontfamily{combotest}\selectfont -- 
Some Text with Capital Words fi
Eh bien, mon prince. Gênes et Lueques ne sont plus que des
apanages, des поместья, de la famille Buonaparte êßä
%
\large
Some Text with Capital Words
Eh bien, mon prince. Gênes et Lueques ne sont plus que des
apanages, des поместья, de la famille Buonaparte

\tiny

Some Text with Capital Words
Eh bien, mon prince. Gênes et Lueques ne sont plus que des
apanages, des поместья, de la famille Buonaparte êßä

\bfseries 
\normalsize

Some Text with Capital Words fi
Eh bien, mon prince. Gênes et Lueques ne sont plus que des
apanages, des поместья, de la famille Buonaparte êßä
%
\large
Some Text with Capital Words
Eh bien, mon prince. Gênes et Lueques ne sont plus que des
apanages, des поместья, de la famille Buonaparte

\tiny 

Some Text with Capital Words fi
Eh bien, mon prince. Gênes et Lueques ne sont plus que des
apanages, des поместья, de la famille Buonaparte êßä
%


\end{document}



\ExplSyntaxOn
\__combo_call_basefonts:n {mycombofont}

\l_combo_tmpfont_i_tl abc

\l_combo_tmpfont_ii_tl abc

%\tl_show:N \l__combo_mycombofont_combodesc_tl
 \font\testfont =\l__combo_mycombofont_combodesc_tl


 \testfont Abc

 %\edef\test{\noexpand\font\noexpand\mytestfont = \unexpanded\expandafter{\l__combo_mycombofont_combodesc_tl}}
% \test abc

\ExplSyntaxOff


> external@font=macro:
->"combo: 1 -> fontid one ; 2 -> fontid two , 0x41-0x5A;".

> external@font=macro:
->"combo:1->fontid l_combo_tmpfont_i_tl ;2->fontid l_combo_tmpfont_ii_tl ;".

\documentclass[parskip=half-]{scrartcl}
\usepackage{fontspec,xfp}

\newcommand\requestmycombofont[1]{%
\font \one = {file:lmmono10-regular.otf} at \fpeval{#1*10}pt
\font \two = {file:lmsans10-regular.otf} at \fpeval{#1*15}pt
\def\mycombofont{"combo: 1 -> \fontid \one ;
2 -> \fontid \two , 0x41-0x5A;"}
}

\makeatletter
\DeclareSizeFunction{ulrike}{\ulrike@sfcnt\@font@warning}
\def\ulrike@sfcnt#1{%
\requestmycombofont{\fpeval{\f@size/10}}%
\expandafter\def\expandafter\external@font\expandafter{\mycombofont}
}%

\DeclareFontFamily{TU}{xxx}{}

\DeclareFontShape{TU}{xxx}{m}{n}{<->ulrike*zzz}{}



\begin{document}

\section{Call through nfss?}
\normalsize
\fontfamily{xxx}\selectfont
Some Text with Capital Words

\large
Some Text with Capital Words
\end{document}

\documentclass[parskip=half-]{scrartcl}
\usepackage{fontspec,xfp}

\newcommand\requestmycombofont[1]{%
\font \one = {file:lmmono10-regular.otf} at \fpeval{#1*10}pt
\font \two = {file:lmsans10-regular.otf} at \fpeval{#1*15}pt
\def\mycombofont{"combo: 1 -> \fontid \one ;
2 -> \fontid \two , 0x41-0x5A;"}
}

\makeatletter
\DeclareSizeFunction{ulrike}{\ulrike@sfcnt\@font@warning}
\def\ulrike@sfcnt#1{%
\requestmycombofont{\fpeval{\f@size/10}}%
\expandafter\def\expandafter\external@font\expandafter{\mycombofont}
\show\external@font
}%

\DeclareFontFamily{TU}{xxx}{}

\DeclareFontShape{TU}{xxx}{m}{n}{<->ulrike*zzz}{}



\begin{document}

\section{Call through nfss?}
\normalsize
\fontfamily{xxx}\selectfont
Some Text with Capital Words

\large
Some Text with Capital Words
\end{document} 